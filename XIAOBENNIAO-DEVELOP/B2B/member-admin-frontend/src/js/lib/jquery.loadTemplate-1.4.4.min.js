!function(t){"use strict";function e(e,n,c){var s,u,p,d=this;return n=n||{},p=t.extend(!0,{async:!0,overwriteCache:!1,complete:null,success:null,error:function(){t(this).each(function(){t(this).html(p.errorMessage)})},errorMessage:"There was an error loading the template.",paged:!1,pageNo:1,elemPerPage:10,append:!1,prepend:!1,beforeInsert:null,afterInsert:null,bindingOptions:{ignoreUndefined:!1,ignoreNull:!1,ignoreEmptyString:!1}},c),"array"===t.type(n)?r.call(this,e,n,p):(a(e)||(s=t(e),"string"==typeof e&&0===e.indexOf("#")&&(p.isFile=!1)),u=p.isFile||"undefined"==typeof p.isFile&&("undefined"==typeof s||0===s.length),u&&!p.overwriteCache&&O[e]?o(e,d,n,p):u&&!p.overwriteCache&&O.hasOwnProperty(e)?i(e,d,n,p):u?l(e,d,n,p):f(s,d,n,p),this)}function n(e,n){n?k[e]=n:k=t.extend(k,e)}function a(t){return"string"==typeof t&&t.indexOf("/")>-1}function r(n,a,r){r=r||{};var i,o=this,c=a.length,s=r.prepend&&!r.append,l=0,f=0,u=!1;if(r.paged){var p=(r.pageNo-1)*r.elemPerPage;a=a.slice(p,p+r.elemPerPage),c=a.length}return i=t.extend({},r,{complete:function(){this.html&&(s?o.prepend(this.html()):o.append(this.html())),l++,(l===c||u)&&(u&&r&&"function"==typeof r.error&&r.error.call(o),r&&"function"==typeof r.complete&&r.complete())},success:function(){f++,f===c&&r&&"function"==typeof r.success&&r.success()},error:function(){u=!0}}),r.append||r.prepend||o.html(""),s&&a.reverse(),t(a).each(function(){var a=t("<div/>");if(e.call(a,n,this,i),u)return!1}),this}function i(t,e,n,a){T[t]?T[t].push({data:n,selection:e,settings:a}):T[t]=[{data:n,selection:e,settings:a}]}function o(t,e,n,a){var r=O[t].clone();u.call(e,r,n,a),"function"==typeof a.success&&a.success()}function c(){return(new Date).getTime()}function s(t){return t.indexOf("?")!==-1?t+"&_="+c():t+"?_="+c()}function l(e,n,a,r){var i=t("<div/>");O[e]=null;var o=e;r.overwriteCache&&(o=s(o)),t.ajax({url:o,async:r.async,success:function(t){i.html(t),d(i,e,n,a,r)},error:function(){p(e,n,a,r)}})}function f(e,n,a,r){var i=t("<div/>");(e.is("script")||e.is("template"))&&(e=t.parseHTML(t.trim(e.html()))),i.html(e),u.call(n,i,a,r),"function"==typeof r.success&&r.success()}function u(e,n,a){h(e,n,a),t(this).each(function(){var n=t(e.html());a.beforeInsert&&a.beforeInsert(n),a.append?t(this).append(n):a.prepend?t(this).prepend(n):t(this).html(n),a.afterInsert&&a.afterInsert(n)}),"function"==typeof a.complete&&a.complete.call(t(this))}function p(e,n,a,r){var i;for("function"==typeof r.error&&r.error.call(n),t(T[e]).each(function(t,e){"function"==typeof e.settings.error&&e.settings.error.call(e.selection)}),"function"==typeof r.complete&&r.complete.call(n);T[e]&&(i=T[e].shift());)"function"==typeof i.settings.complete&&i.settings.complete.call(i.selection);"undefined"!=typeof T[e]&&T[e].length>0&&(T[e]=[])}function d(t,e,n,a,r){var i;for(O[e]=t.clone(),u.call(n,t,a,r),"function"==typeof r.success&&r.success.call(n);T[e]&&(i=T[e].shift());)u.call(i.selection,O[e].clone(),i.data,i.settings),"function"==typeof i.settings.success&&i.settings.success.call(i.selection)}function h(e,n,a){n=n||{},m("data-content",e,n,a,function(t,e){t.html(x(t,e,"content",a))}),m("data-content-append",e,n,a,function(t,e){t.append(x(t,e,"content",a))}),m("data-content-prepend",e,n,a,function(t,e){t.prepend(x(t,e,"content",a))}),m("data-content-text",e,n,a,function(t,e){t.text(x(t,e,"content",a))}),m("data-src",e,n,a,function(t,e){t.attr("src",x(t,e,"src",a))},function(t){t.remove()}),m("data-href",e,n,a,function(t,e){t.attr("href",x(t,e,"href",a))},function(t){t.remove()}),m("data-alt",e,n,a,function(t,e){t.attr("alt",x(t,e,"alt",a))}),m("data-download",e,n,a,function(t,e){t.attr("download",x(t,e,"download",a))}),m("data-title",e,n,a,function(t,e){t.attr("title",x(t,e,"title",a))}),m("data-id",e,n,a,function(t,e){t.attr("id",x(t,e,"id",a))}),m("data-value",e,n,a,function(t,e){t.attr("value",x(t,e,"value",a))}),m("data-link",e,n,a,function(e,n){var r=t("<a/>");r.attr("href",x(e,n,"link",a)),r.html(e.html()),e.html(r)}),m("data-link-wrap",e,n,a,function(e,n){var r=t("<a/>");r.attr("href",x(e,n,"link-wrap",a)),e.wrap(r)}),m("data-options",e,n,a,function(e,n){t(n).each(function(){var n=t("<option/>");n.attr("value",this).text(this).appendTo(e)})}),y(e,n,a)}function m(e,n,a,r,i,o){t("["+e+"]",n).each(function(){var n=t(this),c=n.attr(e),s=w(a,c);return v(n,s,r)?(n.removeAttr(e),void("undefined"!=typeof s&&i?i(n,s):o&&o(n))):void n.remove()})}function v(t,e,n){var a=g(t,n);return(!a.ignoreUndefined||"undefined"!=typeof e)&&((!a.ignoreNull||null!==e)&&(!a.ignoreEmptyString||""!==e))}function g(e,n){var a={};return e instanceof jQuery&&e.attr("data-binding-options")?(a=t.parseJSON(e.attr("data-binding-options")),e.removeAttr("data-binding-options")):"object"==typeof e&&e.hasOwnProperty("bindingOptions")&&(a=e.bindingOptions),t.extend({},n.bindingOptions,a)}function y(e,n,a){t("[data-template-bind]",e).each(function(){var e=t(this),r=t.parseJSON(e.attr("data-template-bind"));e.removeAttr("data-template-bind"),t(r).each(function(){var r;if(r="object"==typeof this.value?w(n,this.value.data):w(n,this.value),this.attribute){if(!v(this,r,a))return void e.remove();switch(this.attribute){case"content":e.html(b(e,r,this));break;case"contentAppend":e.append(b(e,r,this));break;case"contentPrepend":e.prepend(b(e,r,this));break;case"contentText":e.text(b(e,r,this));break;case"options":var i=this;t(r).each(function(){var n=t("<option/>");n.attr("value",this[i.value.value]).text(b(e,this[i.value.content],i)).attr("selected",void 0!=typeof this[i.value.selected]&&this[i.value.selected]).appendTo(e)});break;default:e.attr(this.attribute,b(e,r,this))}}})})}function b(t,e,n,a){return n.formatter&&k[n.formatter]?function(a){return k[n.formatter].call(t,e,n.formatOptions,a)}(a):e}function w(t,e){if("this"===e)return t;for(var n,a=e.split("."),r=t;(n=a.shift())&&"undefined"!=typeof r&&null!=r;)r=r[n];return r}function x(e,n,a,r){var i,o=e.attr("data-format-target");if((o===a||!o&&"content"===a)&&(i=e.attr("data-format"),i&&"function"==typeof k[i])){var c=e.attr("data-format-options");return function(a){return k[i].call(e[0],n,c,t.extend({},a))}(r)}return n}var O={},T={},k={};n("nestedTemplateFormatter",function(e,n,a){if(n){"string"==typeof n&&"{"===n[0]&&(n=t.parseJSON(n));var r=n.parentElement||"div",i=n.template||n;return n.parentElement?t("<"+r+"/>").loadTemplate(i,e,a):t("<"+r+"/>").loadTemplate(i,e,a).children()}}),t.fn.loadTemplate=e,t.addTemplateFormatter=n}(jQuery);